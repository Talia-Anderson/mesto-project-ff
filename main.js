(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-12",headers:{authorization:"bbcf2270-d3d0-40fa-b649-4e22b6be7820","Content-Type":"application/json"}},t=function(t,n,o){fetch("".concat(e.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))})).catch((function(e){return console.log(e)})).then((function(e){n.classList.toggle("card__like-button_is-active"),o.textContent=e.likes.length}))},n=function(t,n,o){fetch("".concat(e.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))})).catch((function(e){return console.log(e)})).then((function(e){n.classList.toggle("card__like-button_is-active"),o.textContent=e.likes.length}))},o=function(t){fetch("".concat(e.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:e.headers})};function r(e){"Escape"===e.key&&c(document.querySelector(".popup_is-opened"))}function c(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",r)}function a(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",r)}function u(e,o,r){e.classList.contains("card__like-button_is-active")?n(o,e,r):t(o,e,r)}function i(e,t){e.target.closest(".places__item").remove(),o(t)}var s=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))},l=document.querySelector(".places__list");function d(e){var t=function(e,t,n,o){var r=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),c=r.querySelector(".card__title"),a=r.querySelector(".card__image"),u=r.querySelector(".card__delete-button"),i=r.querySelector(".card__like-button");a.src=e.link,a.alt=e.name,c.textContent=e.name;var s=r.querySelector("#counter");return console.log(e.likes),s.textContent=e.likes.length,function(e){for(var t=!1,n=0;n<e.likes.length&&1!=t;n+=1)"a93de75c814e52d57e28a89d"===e.likes[n]._id&&(t=!0);return t}(e)&&i.classList.toggle("card__like-button_is-active"),u.addEventListener("click",(function(){t(event,e.cardID)})),i.addEventListener("click",(function(){n(i,e.cardID,s)})),"a93de75c814e52d57e28a89d"===e.ownerID&&u.classList.remove("hidden"),a.addEventListener("click",(function(t){o(e)})),r}(e,i,u,D);l.append(t)}var p,f=document.querySelector(".popup_type_image"),_=document.querySelector(".profile__edit-button"),m=document.querySelector(".profile__add-button"),v=Array.from(document.querySelectorAll(".popup")),y=document.querySelector(".popup_type_edit"),h=document.querySelector(".popup_type_new-card"),S=h.querySelector(".popup__form"),b=y.querySelector(".popup__form"),k=b.querySelector(".popup__input_type_name"),q=b.querySelector(".popup__input_type_description"),g=document.querySelector(".overlay"),C=document.querySelector(".popup_type_new-avatar"),L=C.querySelector(".popup__form"),E=L.querySelector("#popup__input-avatar"),j=C.querySelector(".popup__button"),x=y.querySelector(".popup__button"),w=h.querySelector(".popup__button");function D(e){var t=f.querySelector(".popup__caption"),n=f.querySelector(".popup__image");t.textContent=e.name,n.src=e.link,n.alt=e.name,a(f)}g.addEventListener("click",(function(){a(C)})),_.addEventListener("click",(function(){var e=document.querySelector(".profile__title"),t=document.querySelector(".profile__description");k.value=e.textContent,q.value=t.textContent,a(y)})),m.addEventListener("click",(function(){return a(h)})),v.forEach((function(e){e.querySelector(".popup__close").addEventListener("click",(function(){return c(e)})),window.addEventListener("click",(function(t){t.target===e&&c(e)}))})),L.addEventListener("submit",(function(t){t.preventDefault(),function(t){fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:t.value})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))})).catch((function(e){return console.log(e)})).then((function(e){document.querySelector("#avatar").style.backgroundImage="url(".concat(e.avatar,")")}))}(E),j.textContent="Сохранение...",c(C)})),b.addEventListener("submit",(function(t){t.preventDefault(),function(t,n){fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:t.value,about:n.value})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))})).catch((function(e){return console.log(e)}))}(k,q),document.querySelector(".profile__title").textContent=k.value,document.querySelector(".profile__description").textContent=q.value,x.textContent="Сохранение...",c(y)})),S.addEventListener("submit",(function(t){t.preventDefault();var n=S.querySelector(".popup__input_type_card-name"),o=S.querySelector(".popup__input_type_url");!function(t,n,o,r,c,a,u){fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:c.value,link:a.value})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))})).catch((function(e){return console.log(e)})).then((function(e){o={name:e.name,link:e.link,likes:e.likes.length,ownerID:e.owner._id,cardID:e._id}})).then((function(e){n(o),r.textContent="Сохранение...",t(u)}))}(c,d,void 0,w,n,o,h)})),p={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(p.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);s(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){if(t.validity.patternMismatch){var o=t.dataset.errorMessage;t.setCustomValidity(o)}else t.setCustomValidity("");t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.textContent="",o.classList.remove(n.errorClass)}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add("".concat(o.inputErrorClass)),r.textContent=n,r.classList.add("".concat(o.errorClass))}(e,t,t.validationMessage,n)}(e,r,t),s(n,o,t)}))}))}(e,p)})),fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))})).catch((function(e){return console.log(e)})).then((function(e){var t=e.name,n=e.about;document.querySelector("#name").textContent=t,document.querySelector("#about").textContent=n,document.querySelector("#avatar").style.backgroundImage="url(".concat(e.avatar,")")})),function(t){fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))})).catch((function(e){return console.log(e)})).then((function(e){e.forEach((function(e){var n=new URL(e.link,"file:///C:/Users/HUAWEI/mesto-project-ff/src/components/api.js"),o={name:e.name,link:n,likes:e.likes,ownerID:e.owner._id,cardID:e._id};t(o)}))}))}(d)})();